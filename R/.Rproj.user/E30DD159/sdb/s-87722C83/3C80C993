{
    "contents" : "#Do exploratory data analysis on the data pulled from the Destiny Platform REST API\n#This relies on files we created doing exploratory anaylsis in Python\n#This file is different than the Python one because this one will generate plots\n\nlibrary(\"ggplot2\")\nlibrary(\"doBy\")\n\n#load functions created to access the Destiny SQLite database\nsource('~/CSCI183/DestinyBlogProject/manifestConnect.R')\n\n#within the dataset, 0 is victory, 1 is defeat\n#if we take the mean of the standing column, we get DEFEAT RATE\n#we want VICTORY RATE, so subtract 1 from DEFEAT RATE\nvictoryRate <- function(x) {\n  return(1-mean(x))\n}\n\ndata <- read.csv(\"../data.csv\")\n\ngrouped.byWeapon <- summaryBy(X ~ mostUsedWeapon1Name, data = data, FUN=length)\ngrouped.byWeapon <- grouped.byWeapon[order(grouped.byWeapon$X.length), ]\n\ntopWeapons <- tail(grouped.byWeapon, 16)\ntopWeapons <- subset(topWeapons, topWeapons$mostUsedWeapon1Name != 'None')\n\n#create plot for how often the top 15 weapons are used\nprint(ggplot(data = topWeapons, \n             aes(x=mostUsedWeapon1Name, y=X.length/nrow(data), fill=mostUsedWeapon1Name)) + \n        geom_bar(stat='identity') + \n        ggtitle(\"Top 15 Weapons Used\") + \n        labs(x= \"Weapon Name\", y=\"Usage Rate\", fill=\"Weapon Name\")+\n        theme(axis.text.x = element_text(angle = 90, hjust = 1)))\n\ntopWeapons_sub = subset(data, data$mostUsedWeapon1Name %in% topWeapons$mostUsedWeapon1Name)\ntopWeaponsVictory <- summaryBy(standing ~ mostUsedWeapon1Name, data = topWeapons_sub, FUN=victoryRate)\nprint(ggplot(data=topWeaponsVictory,\n             aes(x=mostUsedWeapon1Name, y = standing.victoryRate, fill = mostUsedWeapon1Name)) +\n        geom_bar(stat='identity') +\n        ggtitle(\"Top 15 Weapons Victory Rate\")+ \n        labs(x='Weapon Name', y ='Victory Rate', fill='Weapon Name')+\n        theme(axis.text.x = element_text(angle = 90, hjust = 1)))\n\n\n#create plot for the rate of victory using those 15 weapons\n#print(ggplot(data = topWeapons, \n#             aes(x=name, y=victoryRate, fill=name)) + \n#        geom_bar(stat='identity') + \n#        ggtitle(\"Victory Rate using the Top 15 Weapons\") + \n#        theme(axis.text.x = element_text(angle = 90, hjust = 1)))\n\n#look at victory rate by combat rating\ncombatRatingHist <- hist(data$combatRating)\n\ndata$combatRatingBins <- cut(data$combatRating, combatRatingHist$breaks)\ngrouped.byCombatRating <- summaryBy(standing ~ combatRatingBins, data = data, FUN=victoryRate)\n\nprint(ggplot(data=grouped.byCombatRating, \n             aes(x=combatRatingBins, y=standing.victoryRate, fill=combatRatingBins)) +\n        geom_bar(stat='identity') +\n        ggtitle(\"Victory Rate by Combat Rating\") +\n        theme(axis.text.x = element_text(angle = 90, hjust = 1)))\n\n\n#look at map data\ngrouped.byMap = summaryBy(standing ~ refrencedId + team, data=data, FUN=victoryRate)\ngrouped.byMap = subset(grouped.byMap, grouped.byMap$team != -1)\ngrouped.byMap$mapName <- unlist(lapply(grouped.byMap$refrencedId, \n                                       FUN = function(x){getMapName(destiny.manifest,x)}))\n\nprint(ggplot(data=grouped.byMap, \n       aes(x=mapName, y = standing.victoryRate, fill=factor(team, labels=c(\"Alpha\",\"Bravo\")))) + \n  geom_bar(stat=\"identity\", position = \"dodge\") +\n  ggtitle(\"Victory Rate by Map\") +\n  labs(fill=\"Teams\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)))\n\ngrouped.byMapFreq = summaryBy(X ~ refrencedId, data = data, FUN=length)\ngrouped.byMapFreq$freq <- grouped.byMapFreq$X.length / nrow(data)\ngrouped.byMapFreq$mapName <- unlist(lapply(grouped.byMapFreq$refrencedId, \n                                       FUN = function(x){getMapName(destiny.manifest,x)}))\nprint(ggplot(data=grouped.byMapFreq,\n             aes(x=mapName, y = freq))+\n        geom_bar(stat='identity',position='dodge') +\n        ggtitle(\"Map Frequency\") +\n        labs(x=\"Map Name\", y= \"Frequency\")+\n        theme(axis.text.x = element_text(angle = 90, hjust = 1)))\n\n#quitting data\nquitters <- subset(data, data$completed == 0)\nquitters <- subset(quitters, quitters$team != -1)\ngroupQuitters.byMap <- summaryBy(X ~ refrencedId + team, data=quitters, FUN=length)\ngroupQuitters.byMap$mapName <- unlist(lapply(groupQuitters.byMap$refrencedId, \n                                           FUN = function(x){getMapName(destiny.manifest,x)}))\nquitMapPlot <- ggplot(data=groupQuitters.byMap, \n                      aes(x=mapName, y=X.length, fill = factor(team, labels=c('Alpha','Bravo')))) +\n  geom_bar(stat='identity', position='dodge')+\n  labs(x='Map Name', fill='Team', color='Team', y=\"Number Of Quitters\") +\n  ggtitle(\"Quiting by Map and Team\")+\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\nprint(quitMapPlot)\n\n",
    "created" : 1431981374853.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1218415171",
    "id" : "3C80C993",
    "lastKnownWriteTime" : 1433609496,
    "path" : "~/CSCI183/DestinyBlogProject/R/exploratoryAnalysis.R",
    "project_path" : "exploratoryAnalysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}